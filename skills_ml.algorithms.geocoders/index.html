



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.6">
    
    
      
        <title>Skills ml.algorithms.geocoders - skills-ml documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#-state_name_lookup" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="skills-ml documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                skills-ml documentation
              </span>
              <span class="md-header-nav__topic">
                Skills ml.algorithms.geocoders
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="skills-ml documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    skills-ml documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../skills_ml_tour/" title="Tour" class="md-nav__link">
      Tour
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../ontologies/" title="Ontology Class" class="md-nav__link">
      Ontology Class
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../common_schema/" title="Job Posting Common Schema" class="md-nav__link">
      Job Posting Common Schema
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../skills_ml.evaluation/" title="Evaluation Tools" class="md-nav__link">
      Evaluation Tools
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../skills_ml.algorithms/" title="Algorithms" class="md-nav__link">
      Algorithms
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../skills_ml.job_postings/" title="Job Posting Dataset Processors" class="md-nav__link">
      Job Posting Dataset Processors
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../skills_ml.datasets/" title="External Dataset Processors" class="md-nav__link">
      External Dataset Processors
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#-state_name_lookup" title="- STATE_NAME_LOOKUP" class="md-nav__link">
    - STATE_NAME_LOOKUP
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#job_posting_search_strings" title="job_posting_search_strings" class="md-nav__link">
    job_posting_search_strings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#s3cachedgeocoder" title="S3CachedGeocoder" class="md-nav__link">
    S3CachedGeocoder
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#s3cachedgeocoderall_cached_geocodes" title="S3CachedGeocoder.all_cached_geocodes" class="md-nav__link">
    S3CachedGeocoder.all_cached_geocodes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3cachedgeocoder__init__" title="S3CachedGeocoder.__init__" class="md-nav__link">
    S3CachedGeocoder.__init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3cachedgeocodergeocode" title="S3CachedGeocoder.geocode" class="md-nav__link">
    S3CachedGeocoder.geocode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3cachedgeocodergeocode_job_postings_and_save" title="S3CachedGeocoder.geocode_job_postings_and_save" class="md-nav__link">
    S3CachedGeocoder.geocode_job_postings_and_save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3cachedgeocoderretrieve_from_cache" title="S3CachedGeocoder.retrieve_from_cache" class="md-nav__link">
    S3CachedGeocoder.retrieve_from_cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3cachedgeocodersave" title="S3CachedGeocoder.save" class="md-nav__link">
    S3CachedGeocoder.save
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Skills ml.algorithms.geocoders</h1>
                
                <p><strong>Source:</strong> <a href="https://github.com/workforce-data-initiative/skills-ml/tree/master/skills-ml/skills_ml/algorithms/geocoders/__init__.py#L0">skills-ml/skills_ml/algorithms/geocoders/<strong>init</strong>.py#L0</a>
<strong>Global Variables</strong></p>
<hr />
<h3 id="-state_name_lookup"><a class="toclink" href="#-state_name_lookup">- <strong>STATE_NAME_LOOKUP</strong></a><a class="headerlink" href="#-state_name_lookup" title="Permanent link">&para;</a></h3>
<h4 id="job_posting_search_strings"><a class="toclink" href="#job_posting_search_strings"><a href="https://github.com/workforce-data-initiative/skills-ml/tree/master/skills-ml/skills_ml/algorithms/geocoders/__init__.py#L15">job_posting_search_strings</a></a><a class="headerlink" href="#job_posting_search_strings" title="Permanent link">&para;</a></h4>
<pre><code class="python">job_posting_search_strings(job_posting)
</code></pre>

<p>Convert a job posting to a geocode-ready search string</p>
<p>Includes city and state if present, or just city</p>
<p><em>Args:</em></p>
<p>job_posting (string) A job posting in schema.org/JobPosting json form</p>
<p><em>Returns: (string) A geocode-ready search string</em></p>
<hr />
<h3 id="s3cachedgeocoder"><a class="toclink" href="#s3cachedgeocoder"><a href="https://github.com/workforce-data-initiative/skills-ml/tree/master/skills-ml/skills_ml/algorithms/geocoders/__init__.py#L44">S3CachedGeocoder</a></a><a class="headerlink" href="#s3cachedgeocoder" title="Permanent link">&para;</a></h3>
<p>Geocoder that uses S3 as a cache.</p>
<p><em>Args:</em></p>
<p>s3_conn (boto.s3.connection) an s3 connection
  cache_s3_path (string) path (including bucket) to the json cache on s3
  geocode_func (function) a function that geocodes a given search string
  defaults to the OSM geocoder provided by the geocode library
  sleep_time (int) The time, in seconds, between geocode calls</p>
<h5 id="s3cachedgeocoderall_cached_geocodes"><a class="toclink" href="#s3cachedgeocoderall_cached_geocodes">S3CachedGeocoder.all_cached_geocodes</a><a class="headerlink" href="#s3cachedgeocoderall_cached_geocodes" title="Permanent link">&para;</a></h5>
<p>Return the contents of the geocoding cache</p>
<p><em>Returns: (dict) search strings mapping to their (dict) geocoded results</em></p>
<hr />
<h4 id="s3cachedgeocoder__init__"><a class="toclink" href="#s3cachedgeocoder__init__"><a href="https://github.com/workforce-data-initiative/skills-ml/tree/master/skills-ml/skills_ml/algorithms/geocoders/__init__.py#L54">S3CachedGeocoder.<code>__init__</code></a></a><a class="headerlink" href="#s3cachedgeocoder__init__" title="Permanent link">&para;</a></h4>
<pre><code class="python">__init__(self, s3_conn, cache_s3_path, geocode_func=&lt;function osm at 0x7fd512527b70&gt;, \
    sleep_time=1)
</code></pre>

<p>Initialize self.  See help(type(self)) for accurate signature.</p>
<hr />
<h4 id="s3cachedgeocodergeocode"><a class="toclink" href="#s3cachedgeocodergeocode"><a href="https://github.com/workforce-data-initiative/skills-ml/tree/master/skills-ml/skills_ml/algorithms/geocoders/__init__.py#L112">S3CachedGeocoder.geocode</a></a><a class="headerlink" href="#s3cachedgeocodergeocode" title="Permanent link">&para;</a></h4>
<pre><code class="python">geocode(self, search_string)
</code></pre>

<p>Geocodes a single search string</p>
<p>First checks in cache to see if the search string has been geocoded
If the geocoding function is called, the process will sleep afterwards</p>
<p>Warning: Not to be used in parallel!
To respect throttling limits, it would be dangerous to try and run more
then one of these against a geocoder service. As a result, the code
assumes that when it comes time to save, there have been no
external changes to the file on S3 worth keeping.</p>
<p><em>Args:</em></p>
<p>search_string (string) A search query to send to the geocoder
<em>Returns: (string) The geocoding result</em></p>
<hr />
<h4 id="s3cachedgeocodergeocode_job_postings_and_save"><a class="toclink" href="#s3cachedgeocodergeocode_job_postings_and_save"><a href="https://github.com/workforce-data-initiative/skills-ml/tree/master/skills-ml/skills_ml/algorithms/geocoders/__init__.py#L154">S3CachedGeocoder.geocode_job_postings_and_save</a></a><a class="headerlink" href="#s3cachedgeocodergeocode_job_postings_and_save" title="Permanent link">&para;</a></h4>
<pre><code class="python">geocode_job_postings_and_save(self, job_postings, save_every=100000)
</code></pre>

<p>Geocode job postings and save the results to S3</p>
<p><em>Args:</em></p>
<p>job_postings (iterable) Job postings in common schema format
  save_every (int) How frequently to defensively save the cache
  Defaults to every 100000 job postings</p>
<hr />
<h4 id="s3cachedgeocoderretrieve_from_cache"><a class="toclink" href="#s3cachedgeocoderretrieve_from_cache"><a href="https://github.com/workforce-data-initiative/skills-ml/tree/master/skills-ml/skills_ml/algorithms/geocoders/__init__.py#L92">S3CachedGeocoder.retrieve_from_cache</a></a><a class="headerlink" href="#s3cachedgeocoderretrieve_from_cache" title="Permanent link">&para;</a></h4>
<pre><code class="python">retrieve_from_cache(self, job_posting)
</code></pre>

<p>Retrieve a saved geocode result from the cache if it exists</p>
<p>Usable in parallel, since it will not perform geocoding on its own.
This means that you should make code that calls this dependent
on the geocoding for the job posting being completed</p>
<p><em>Args:</em></p>
<p>job_posting (string) A job posting in schema.org/JobPosting json form
<em>Returns: (string) The geocoding result, or None if none is available</em></p>
<hr />
<h4 id="s3cachedgeocodersave"><a class="toclink" href="#s3cachedgeocodersave"><a href="https://github.com/workforce-data-initiative/skills-ml/tree/master/skills-ml/skills_ml/algorithms/geocoders/__init__.py#L136">S3CachedGeocoder.save</a></a><a class="headerlink" href="#s3cachedgeocodersave" title="Permanent link">&para;</a></h4>
<pre><code class="python">save(self)
</code></pre>

<p>Save the geocoding cache to S3</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.5e60981f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>